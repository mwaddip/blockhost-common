# Blockhost VM Database Configuration
# This file configures the VM provisioning database and resource pools.
#
# Managed by: blockhost-common
# Used by: blockhost-provisioner-proxmox, blockhost-engine
#
# Schema Notes:
# - All fields are optional; sensible defaults are applied
# - vmid_range and vmid_pool are accepted interchangeably
# - ip_pool.start/end accept integers (last octet) or full IP strings

# Database file path (JSON file tracking VMs, IPs, and NFT tokens)
# Default: /var/lib/blockhost/vms.json
db_file: /var/lib/blockhost/vms.json

# Terraform working directory — set by provisioner if needed (optional)
# terraform_dir: /var/lib/blockhost/terraform

# Field name mappings (optional - defaults shown below)
# Used for compatibility/migration to other backends
fields:
  vm_name: vm_name
  vmid: vmid
  ip_address: ip_address
  expires_at: expires_at
  owner: owner
  status: status
  created_at: created_at

# IPv4 allocation pool for provisioned VMs
# start/end can be integers (last octet only) or full IP strings:
#   start: 200                    # Integer format (recommended)
#   start: "192.168.122.200"      # Full IP string format (also accepted)
ip_pool:
  network: "192.168.122.0/24"
  start: 200
  end: 250
  gateway: "192.168.122.1"

# IPv6 allocation pool for provisioned VMs
# The prefix is read from /etc/blockhost/broker-allocation.json (created by broker-client)
# These settings control which addresses within the prefix are allocated to VMs
ipv6_pool:
  start: 2    # Skip ::0 (network) and ::1 (Proxmox host uses ::1)
  end: 254    # Last usable address in a /120

# VMID range for dynamically created VMs — set by provisioner if needed (optional)
# Note: vmid_pool is also accepted as an alias for vmid_range
# vmid_range:
#   start: 100
#   end: 999

# Default expiry for new VMs (in days)
# VMs are automatically marked for garbage collection after this period
default_expiry_days: 30

# Grace period before garbage collector destroys expired VMs (in days)
# Users have this many days after suspension to renew before VM destruction
gc_grace_days: 7
